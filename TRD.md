# TRD

# AI ì¼€ì´í¬ ë””ìì¸ ì„œë¹„ìŠ¤ PRD (Lovableâ€‘Ready)

## 0. í•œëˆˆ ìš”ì•½ (Executive Oneâ€‘Pager)

- **ë¬¸ì œ**: ì¸ìŠ¤íƒ€ DM/ì „í™”ë¡œ ì‹œì‘ë˜ëŠ” ë¹„êµ¬ì¡°í™” ìƒë‹´ â†’ ê¸´ ë¦¬ë“œíƒ€ì„, ë‚®ì€ ì „í™˜ìœ¨, ê°€ê²©Â·ìŠ¤íƒ€ì¼ ë¶ˆì¼ì¹˜.
- **í•´ê²°**: ì‚¬ì´íŠ¸ ì„ë² ë“œ(Lovable)ì—ì„œ **StylePack ê¸°ë°˜ AI ì œì•ˆ 3ì¢…** ìƒì„± â†’ ê³ ê°ì´ ì„ í˜¸ì•ˆ ì„ íƒ â†’ **ì˜ˆì•½ê¸ˆ ì˜¨ë¼ì¸ ê²°ì œ** â†’ ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œì—ì„œ ì§„í–‰.
- **ëŒ€ìƒ**: êµ¬ë§¤ ê³ ê°(í–‰ì‚¬ìš© ì¼€ì´í¬), ê´€ë¦¬ì/ë² ì´ì»¤(ìŠ¤íƒ€ì¼Â·ì‚¬ì´ì¦ˆÂ·ê°€ê²©Â·ë¦¬ë“œíƒ€ì„ ì†Œìœ ).
- **í•µì‹¬ KPI(MVP)**: ì œì•ˆ ì™„ë£Œìœ¨ â‰¥ 60%, ê²°ì œ ì „í™˜ìœ¨ â‰¥ 25%, ì´ˆê¸° ìƒë‹´ ì‹œê°„ 50%â†“.
- **í•µì‹¬ ì œì•½**: ë””ìì¸ì€ **StylePack(íŒë§¤ì ì •ì˜ ë²”ìœ„)** ë¥¼ **í•˜ë“œ ì œì•½**ìœ¼ë¡œ ì¤€ìˆ˜. ê³ ê° ì…ë ¥ì€ **ì†Œí”„íŠ¸ ì œì•½**.
- **ë²”ìœ„(MVP)**: ì„ë² ë“œ UX, ì œì•ˆ 3ì¢…, ì˜ˆì•½ê¸ˆ ê²°ì œ, ìƒíƒœ ë™ê¸°í™”, ì´ë©”ì¼/ì•Œë¦¼, ê¸°ë³¸ ëŒ€ì‹œë³´ë“œ.

---

## 1. ë°°ê²½Â·ëª©í‘œÂ·ì›ì¹™

### 1.1 ë°°ê²½

- ê³ ê° ë‹ˆì¦ˆê°€ ì´ë¯¸ì§€/ë¬¸ì¥ ë‹¨ìœ„ë¡œ ë¹„ì •í˜• ìœ ì… â†’ ìƒë‹´ ë°˜ë³µ, ê²¬ì  ë¶ˆì¼ì¹˜, ì œì‘ ë¶ˆê°€ ì‹œì•ˆ ë¹ˆë°œ.
- ë² ì´ì»¤ëŠ” ë¸Œëœë“œ ì¼ê´€ì„±(ìŠ¤íƒ€ì¼íŒ©)ê³¼ í˜„ì‹¤ì„±(ì§€ì§€ëŒ€/ìš´ì†¡)ì„ ë³´ì¥í•´ì•¼ í•¨.

### 1.2 ëª©í‘œ(Objectives)

- ì›¹ ì„ë² ë“œì—ì„œ **5ë¶„ ë‚´** ì„ í˜¸ì•ˆ ì„ íƒê¹Œì§€ ìœ ë„, **ì¦‰ì‹œ ì˜ˆì•½ê¸ˆ ìˆ˜ë‚©**ê¹Œì§€ ì™„ê²°.
- StylePack/SizeCategoryë¥¼ í‘œì¤€í™”í•˜ì—¬ **í˜„ì‹¤ ì œì‘ ê°€ëŠ¥** ì‹œì•ˆë§Œ ì œì•ˆ.
- íšŒê³„Â·ìš´ì˜ì€ ê²½ëŸ‰ìœ¼ë¡œ ì‹œì‘(MVP), ì ì§„ì  ìë™í™”.

### 1.3 ì œí’ˆ ì›ì¹™

- **ê²ŒìŠ¤íŠ¸ í¼ìŠ¤íŠ¸**: ë¡œê·¸ì¸ ì—†ì´ ìƒì„±Â·ë¯¸ë¦¬ë³´ê¸° ê°€ëŠ¥, **ê²°ì œ ì‹œì **ì— ìµœì†Œ ì •ë³´ ìˆ˜ì§‘.
- **ì œì•½ ë‚´ ììœ **: StylePackì€ í•˜ë“œ ì œì•½, ê³ ê° ì…ë ¥ì€ ì†Œí”„íŠ¸ ì œì•½.
- **ë¹„ë™ê¸° ê¸°ë³¸**: ìƒì„±ì€ íÂ·ì›Œì»¤ë¡œ ì²˜ë¦¬, UIëŠ” ì•Œë¦¼Â·SSE/í´ë§.

---

## 2. ìš©ì–´ì§‘(Glossary)

- **StylePack**: íŒë§¤ì ì—…ë¡œë“œ ì´ë¯¸ì§€/íŒ”ë ˆíŠ¸/í˜•ìƒ í…œí”Œë¦¿/í—ˆìš© ì¥ì‹/ê¸ˆì§€ì–´/LoRA ì°¸ì¡°ì˜ ë¬¶ìŒ.
- **SizeCategory**: í‹°ì–´/ì§€ë¦„/ë†’ì´/ì„œë¹™ ìˆ˜/ê¸°ë³¸ê°€/ë¦¬ë“œíƒ€ì„/ìš´ì†¡ ë°˜ê²½ í”„ë¡œí•„.
- **Proposal(ì œì•ˆì•ˆ)**: 3ì¢…(conservative/standard/bold) ëª©ì—… ì´ë¯¸ì§€(ì›Œí„°ë§ˆí¬)+ìŠ¤í™+ê°€ê²© ë²”ìœ„+ë°°ì§€.
- **í˜„ì‹¤ì„± ë°°ì§€**: ì§€ì§€ëŒ€ í•„ìš”, ìš´ì†¡ ë¦¬ìŠ¤í¬, ì•Œë ˆë¥´ê²/ì €ì‘ê¶Œ ê²½ê³  ë“± ì œì‘Â·ìš´ì†¡ ê´€ì  ì‹ í˜¸.
- **ì˜ˆì•½ê¸ˆ**: ì œì‘ ìŠ¬ë¡¯ í™•ë³´ ëª©ì  ì„ ê²°ì œ. í™˜ë¶ˆÂ·ë³€ê²½ ì •ì±… ë³„ë„ ê³ ì§€.

---

## 3. ì‚¬ìš©ì ë° ì—¬ì •

### 3.1 í˜ë¥´ì†Œë‚˜

- **ê³ ê°**: í–‰ì‚¬ ì¼€ì´í¬ êµ¬ë§¤, ì¸ìŠ¤íƒ€ ì°¸ê³ , ëª¨ë°”ì¼ ì¤‘ì‹¬.
- **ê´€ë¦¬ì/ë² ì´ì»¤**: ìŠ¤íƒ€ì¼Â·ê°€ê²©Â·ë¦¬ë“œíƒ€ì„Â·í˜„ì‹¤ì„± ê·œì¹™ ì •ì˜Â·ìš´ì˜.

### 3.2 ì—”ë“œíˆ¬ì—”ë“œ ì—¬ì •(ê³ ê°, 8ë‹¨ê³„)

1. **ì§„ì…(ì„ë² ë“œ)** â†’ 2) **ì‚¬ì´ì¦ˆ ì„ íƒ** â†’ 3) **ìŠ¤íƒ€ì¼íŒ© ì„ íƒ** â†’ 4) **ì¶”ê°€ ì…ë ¥(ì„ íƒ: í…ìŠ¤íŠ¸/ì˜ê° ì´ë¯¸ì§€)** â†’
2. **AI ì œì•ˆ 3ì¢… ìƒì„±(ë¹„ë™ê¸°)** â†’ 6) **ì„ í˜¸ì•ˆ 1ê°œ ì„ íƒ** â†’ 7) **ì˜ˆì•½ê¸ˆ ê²°ì œ** â†’ 8) **ì™„ë£Œ í™•ì¸/ì´ë©”ì¼**

- _í´ë°±_: 20s ì´ˆê³¼ ì‹œ ì§„í–‰ ìƒíƒœ í‘œì‹œ, 40s ì´ˆê³¼ ì‹œ â€œí…ìŠ¤íŠ¸ ìŠ¤í™ ì´ˆì•ˆâ€ ì œê³µ + ì™„ë£Œ ì•Œë¦¼ êµ¬ë….

### 3.3 ê´€ë¦¬ì ì—¬ì •

- ìŠ¤íƒ€ì¼íŒ© ë‹¤ì¤‘ ì—…ë¡œë“œÂ·íƒœê¹…, Size/Price/LeadTime ì„¤ì •, í˜„ì‹¤ì„± ë£° í…Œì´ë¸” ê´€ë¦¬, ìš”ì²­/ì œì•ˆ/ê²°ì œ ëŒ€ì‹œë³´ë“œ.

---

## 4. ë²”ìœ„(Scope)

### 4.1 Inâ€‘Scope (MVP)

- ì„ë² ë“œ UX(ê²ŒìŠ¤íŠ¸ ëª¨ë“œ), Size/StylePack ê°•ì œ ì„ íƒ, ì œì•ˆ 3ì¢…, ì„ í˜¸ì•ˆ ì„ íƒ.
- **ì˜ˆì•½ê¸ˆ ê²°ì œ**: (ê¶Œì¥) **Stripe ë“± PG ê²°ì œ** â†’ QBOì— **ë™ê¸°í™”**. _(ëŒ€ì•ˆ)_ QBO Payment Link ì‚¬ìš©(ì‚¬ì „ PoC í•„ìš”).
- ê²°ì œ ìƒíƒœ ë™ê¸°í™”(ì›¹í›… ë˜ëŠ” ì•ˆì „ í´ë§), ì´ë©”ì¼ ì•Œë¦¼, ê¸°ë³¸ ëŒ€ì‹œë³´ë“œ(ìš”ì²­/ì œì•ˆ/ê²°ì œ).
- ì—…ë¡œë“œ ì •ì±…(í™•ì¥ìÂ·ìš©ëŸ‰), EXIF ì œê±°, ì´ë¯¸ì§€ 1600px ì›¹ ë³€í™˜.
- ì ‘ê·¼ì„± WCAG 2.1 AA ì¤€ìˆ˜.

### 4.2 Outâ€‘ofâ€‘Scope (ì°¨ê¸°)

- ë°°ë‹¬Â·í”½ì—… ìŠ¤ì¼€ì¤„ëŸ¬, í’€ CRM, ì •êµí•œ íšŒê³„ ê³„ì • ë§¤í•‘ ìë™í™”(ì°¨ê¸°).
- ë¬´ì œí•œ AI ì¬ìˆ˜ì •/ì±„íŒ…í˜• ê³µë™í¸ì§‘.

---

## 5. í•µì‹¬ ê¸°ëŠ¥ ìš”êµ¬ì‚¬í•­(FRD)

### 5.1 ê³ ê° UX

- **ì‚¬ì´ì¦ˆ ì„ íƒ(í•„ìˆ˜)**: ì„œë¹™/ê¸°ë³¸ê°€/ë¦¬ë“œíƒ€ì„/í˜„ì‹¤ì„± ë°°ì§€ ì¦‰ì‹œ í‘œì‹œ.
- **ìŠ¤íƒ€ì¼íŒ© ì„ íƒ(í•„ìˆ˜)**: ì´ë¯¸ì§€ ì¸ë„¤ì¼Â·íŒ”ë ˆíŠ¸ ì¹©Â·í…ìŠ¤ì²˜ íƒœê·¸Â·í—ˆìš©/ê¸ˆì§€ ì¥ì‹.
- **ê³ ê° ì…ë ¥(ì„ íƒ)**: í…ìŠ¤íŠ¸(í…Œë§ˆ/íŒ”ë ˆíŠ¸/í¬ì¸íŠ¸/ë¬¸êµ¬/ì•Œë ˆë¥´ê²), ì˜ê° ì´ë¯¸ì§€ ë‹¤ì¤‘ ì—…ë¡œë“œ.
- **ì œì•ˆ 3ì¢…**: ì›Œí„°ë§ˆí¬ ëª©ì—…, íŒ”ë ˆíŠ¸, í—ˆìš© ì¥ì‹ ë¦¬ìŠ¤íŠ¸, ë‚œì´ë„/ì œì‘ì‹œê°„, **ê°€ê²© ë²”ìœ„**, í˜„ì‹¤ì„± ë°°ì§€, ê¸ˆì§€ ì‹œ ëŒ€ì²´ì•ˆ.
- **ì„ í˜¸ì•ˆ ì„ íƒâ†’ê²°ì œ**: ê²°ì œ ëª¨ë‹¬/ìƒˆ íƒ­ + ì´ë©”ì¼ ì „ì†¡. ì™„ë£Œ ì‹œ ì•± ìƒíƒœ ì—…ë°ì´íŠ¸.

### 5.2 ê´€ë¦¬ì UX

- StylePack ì»¬ë ‰ì…˜ ìƒì„±/ìˆ˜ì •(ë‹¤ì¤‘ ì—…ë¡œë“œ, ìë™ íŒ”ë ˆíŠ¸/í…ìŠ¤ì²˜ íƒœê¹… + ìˆ˜ë™ ë³´ì •).
- Size/Price/LeadTime/ìš´ì†¡ ë°˜ê²½ í¸ì§‘. í˜„ì‹¤ì„± ë£° í…Œì´ë¸”(ì§€ì§€ëŒ€/ì¥ì‹ ë°€ë„/ìš´ì†¡).
- ìš”ì²­/ì œì•ˆ/ê²°ì œ ìƒíƒœ + **ê°ì‚¬ ë¡œê·¸** ì—´ëŒ.

### 5.3 ì˜¤ë¥˜/í´ë°±

- ìƒì„± p95 20s ëª©í‘œ(ìµœëŒ€ 40s). 20sâ†‘ ì§„í–‰ UI, 40sâ†‘ í…ìŠ¤íŠ¸ ì´ˆì•ˆ í´ë°± + ì´ë©”ì¼ ì•Œë¦¼.

---

## 6. AI ì„¤ê³„

### 6.1 ì…ë ¥ ê³„ì¸µ êµ¬ì¡°(ì¤‘ìš”)

- **Hard Constraint**: `StylePack.shape_template`, `palette_range`, `allowed_accents` _(ë°˜ë“œì‹œ ì¤€ìˆ˜)_
- **Soft Constraint**: ê³ ê° í…ìŠ¤íŠ¸Â·ì´ë¯¸ì§€ì—ì„œ ì¶”ì¶œí•œ íŒ”ë ˆíŠ¸/ë¬´ë“œ/ì•¡ì„¼íŠ¸ _(ê°€ì¤‘ì¹˜ ì ìš©)_

### 6.2 ì´ˆê¸° ê°€ì¤‘ì¹˜/íŒŒë¼ë¯¸í„°(ê¶Œì¥ê°’)

- StyleAdapter/LoRA 0.85, Text 0.4, Img2Img 0.25, CFG 6â€“7, Steps 30â€“40
- Negative: ë¡œê³ /ìºë¦­í„°, ë¶€ìœ  ì¥ì‹, ë¬¼ë¦¬ ë¶ˆê°€ êµ¬ì¡°, ê³¼ë„ ë©”íƒˆë¦­ ë“±

### 6.3 í”„ë¡¬í”„íŠ¸ ê³¨ê²©(ê°œë…)

```
[STYLE_HARD]: {stylepack.keywords}/{shape_template}/{palette_range}
[SIZE_HARD]: {tiers_spec}
[ACCENTS_ALLOWED]: {allowed_accents}
[USER_SOFT]: {theme}/{palette}/{accent}/{inscription}
[NEGATIVE]: {policy_forbidden} + (floating, impossible structure, logo, licensed character)

```

### 6.4 ì´ë¯¸ì§€ ìƒì„± ëª¨ë¸

- **ì„ íƒëœ ëª¨ë¸**: Google Gemini 2.5 Flash Image (`google/gemini-2.5-flash-image-preview`)
- **ì ‘ê·¼ ë°©ì‹**: Lovable AI Gatewayë¥¼ í†µí•œ API í˜¸ì¶œ (`https://ai.gateway.lovable.dev/v1/chat/completions`)
- **ì„ íƒ ì´ìœ **:
  - Lovable AI Gatewayë¥¼ í†µí•œ ê°„í¸í•œ ì—°ë™ (LOVABLE_API_KEY ìë™ ì œê³µ, ë³„ë„ API í‚¤ ì„¤ì • ë¶ˆí•„ìš”)
  - í…ìŠ¤íŠ¸ í”„ë¡¬í”„íŠ¸ ê¸°ë°˜ ê³ í’ˆì§ˆ ì´ë¯¸ì§€ ìƒì„±
  - StylePack ì œì•½ ì¡°ê±´ê³¼ ì‚¬ìš©ì ì…ë ¥ì„ í”„ë¡¬í”„íŠ¸ë¡œ í†µí•© ê°€ëŠ¥
  - Base64 ì¸ì½”ë”©ìœ¼ë¡œ ì¦‰ì‹œ ì‚¬ìš© ê°€ëŠ¥, Supabase Storageì— ì—…ë¡œë“œ í›„ URL ì œê³µ
  - Edge Function ê¸°ë°˜ êµ¬í˜„ìœ¼ë¡œ ì¸í”„ë¼ êµ¬ì¶• ë¶ˆí•„ìš”
- **ëŒ€ì•ˆ ê²€í† **: Stable Diffusion (ìì²´ í˜¸ìŠ¤íŒ… í•„ìš”, GPU ì¸í”„ë¼ êµ¬ì¶• ë³µì¡ë„ ì¦ê°€ë¡œ ì œì™¸)
- **êµ¬í˜„ ìœ„ì¹˜**: Supabase Edge Function (`generate-proposals`)
- **ì¶œë ¥ í˜•ì‹**: Base64 ì´ë¯¸ì§€ â†’ Supabase Storage ì—…ë¡œë“œ â†’ ê³µê°œ URL

---

## 7. ë°ì´í„° ëª¨ë¸(ìš”ì•½)

### 7.1 ì—”í„°í‹°

- **StylePack**: `id, name, images[], palette_range, shape_template, allowed_accents[], banned_terms[], lora_ref, created_at`
- **SizeCategory**: `id, tiers_spec(JSON), serving, base_price, lead_time, delivery_radius`
- **Request**: `id, size_category_id, stylepack_id, user_text, parsed_slots(JSON), user_images[], contact(email/phone), consent_flags, access_token, created_at, payment_status, status`
  - `access_token`: ê²ŒìŠ¤íŠ¸ ì‚¬ìš©ì ì ‘ê·¼ í† í° (ë¹„ì¸ì¦ í™˜ê²½ì—ì„œ ë³¸ì¸ ìš”ì²­ ì¡°íšŒìš©)
  - `status`: ìš”ì²­ ìƒíƒœ (DRAFT, GENERATING, PROPOSALS_READY, PAYMENT_PENDING, DEPOSIT_PAID ë“±)
- **Proposal**: `id, request_id, variant(enum), image_url, spec_json, price_range[min,max], badges[], is_selected, created_at`
- **RulesReality**: `id, key, threshold/enum, message, severity`
- **LogsAudit**: `id, request_id, rule_id, action(block|replace|warn), note, created_at`
- **Profiles**: `id (FK to auth.users), email, role, created_at, updated_at`
- **UserRoles**: `id, user_id (FK to auth.users), role (enum: admin|user), created_at`
- **AllowedAdminEmails**: `id, email, is_active, created_at, updated_at`

### 7.2 ì—…ë¡œë“œ ì •ì±…

- í™•ì¥ì: jpg/jpeg/png/webp, **íŒŒì¼ë‹¹ â‰¤ 20MB / ìš”ì²­ë‹¹ â‰¤ 100MB**, EXIF ì œê±°, ì¥ì¶• 1600px, ê¸°ë³¸ ë³´ê´€ 180ì¼.

---

## 8. API ê°œìš” (Lovable Cloud í™˜ê²½)

> **í™˜ê²½**: Supabase Edge Functions (Lovable Cloud ìë™ ë°°í¬)
>
> **ì¸ì¦**: ê²ŒìŠ¤íŠ¸ëŠ” `access_token`, ê´€ë¦¬ìëŠ” JWT
>
> **ë¹„ë™ê¸°**: ìš”ì²­ì€ 202 ë°˜í™˜ + `request_id`, ìƒíƒœëŠ” í´ë§ìœ¼ë¡œ ì¶”ì 

### 8.1 í˜„ì¬ êµ¬í˜„ëœ ì—”ë“œí¬ì¸íŠ¸

- `POST /functions/v1/create-request` â†’ `{ id, access_token, ... }` (ìš”ì²­ ìƒì„±)
- `GET /functions/v1/get-request?requestId={id}&accessToken={token}` â†’ ìš”ì²­ + ì œì•ˆ ì¡°íšŒ

### 8.2 êµ¬í˜„ í•„ìš” ì—”ë“œí¬ì¸íŠ¸

- `POST /functions/v1/generate-proposals` â†’ 3ì¢… ì œì•ˆ ìƒì„± (ë¹„ë™ê¸°, Gemini 2.5 Flash Image ì‚¬ìš©)
- `POST /functions/v1/evaluate-reality-rules` â†’ í˜„ì‹¤ì„± ë°°ì§€ ìƒì„±
- `POST /functions/v1/select-proposal` â†’ ì„ í˜¸ì•ˆ ì„ íƒ + ê²°ì œ ë§í¬
- `POST /functions/v1/payment-webhook` â†’ Stripe ì›¹í›… ì²˜ë¦¬ (Phase 3)

**ìƒ˜í”Œ ì‘ë‹µ â€“ GET `/api/requests/{id}`**

```json
{
  "data": {
    "id": "req_abc123",
    "size_category_id": "size_M",
    "stylepack_id": "sp_modern",
    "payment_status": "PENDING",
    "proposals": [
      {
        "id": "prop_1",
        "variant": "conservative",
        "image_url": "<https://cdn/prop1.jpg>",
        "spec_json": {"tiers":"2T 6+8", "palette":"pastel", "accents":["rosette"]},
        "price_range": [220, 280],
        "badges": ["support_required"]
      }
    ]
  }
}

```

---

## 9. ë¹„ê¸°ëŠ¥(NFR)Â·ë³´ì•ˆÂ·ì •ì±…

### 9.1 ì„±ëŠ¥Â·ê°€ìš©ì„±

- ìƒì„± **p95 â‰¤ 20s(ëª©í‘œ)**, ìµœëŒ€ 40s í´ë°±. ë¹„ìƒì„± API **p95 â‰¤ 400ms**. ê°€ìš©ì„± 99.5%+.
- 4G í™˜ê²½ LCP(ì œì•ˆ ì¸ë„¤ì¼) â‰¤ 2.5s.

### 9.2 ë³´ì•ˆÂ·í”„ë¼ì´ë²„ì‹œ

- ê´€ë¦¬ì JWT/RBAC, CORS/CSP í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸([bakesbymarie.com](http://bakesbymarie.com/)).
- ì—…ë¡œë“œëŠ” **ì„œëª… URL(TTLâ‰ˆ10ë¶„)**, MIME+Magic ê²€ì‚¬.
- PII/ì´ë¯¸ì§€ **180ì¼ ë³´ê´€**, ê³ ê° ìš”ì²­ ì‹œ ì¦‰ì‹œ ì‚­ì œ. ë¡œê·¸(ë¹„ì‹ë³„) 12ê°œì›”.

### 9.3 ë²•ë¬´Â·ê³ ì§€(ë³µë¶™ìš©)

- **ì €ì‘ê¶Œ/ìƒí‘œ**: ê³ ê° ì œê³µ ì½˜í…ì¸ ëŠ” ê³ ê° ì†Œìœ . ì •ì±…ìƒ í—ˆìš©ë˜ì§€ ì•ŠëŠ” ìš”ì†ŒëŠ” ìë™ ëŒ€ì²´Â·ì œì™¸ë  ìˆ˜ ìˆìŒ.
- **ì•Œë ˆë¥´ê²/ë³´ê±´**: ì•Œë ˆë¥´ê¸° ì •ë³´ëŠ” ê³ ê°ì´ ê³ ì§€. ë¯¸ê³ ì§€ ì±…ì„ì€ ê³ ê°ì—ê²Œ ìˆìŒ.
- **í™˜ë¶ˆ/ë³€ê²½**: ì œì‘ ì¤€ë¹„ ì°©ìˆ˜ ì´í›„ í™˜ë¶ˆ ë¶ˆê°€(ì˜ˆ: í”½ì—… 72ì‹œê°„ ì „ ì´í›„). ê·¸ ì´ì „ ì·¨ì†Œ ì‹œ ìˆ˜ìˆ˜ë£Œ X% ê³µì œ.
- **ì´ë¯¸ì§€ ì•ˆë‚´**: ì œì•ˆ ì´ë¯¸ì§€ëŠ” ëª©ì—…ìœ¼ë¡œ ì‹¤ì œ ê²°ê³¼ì™€ ë‹¤ë¥¼ ìˆ˜ ìˆìŒ.

---

## 10. ê²°ì œ/íšŒê³„ í†µí•© (ë¦¬ìŠ¤í¬ ê´€ë¦¬)

### 10.1 ê¶Œì¥ ê²½ë¡œ(Stripe/PG â†’ QBO ë™ê¸°í™”)

- ê³ ê° ê²°ì œëŠ” **Stripe ë“± PG**ë¡œ ì²˜ë¦¬(ëª¨ë°”ì¼ ìµœì í™”/ì‹ ë¢°ë„/ì†ë„).
- ê²°ì œ ì„±ê³µ ì‹œ QBOì— **ìˆ˜ë‚© ë™ê¸°í™”(Invoice/Payment)**. íšŒê³„ ê³„ì • ë§¤í•‘ì€ **ì°¨ê¸°**.

### 10.2 ëŒ€ì•ˆ ê²½ë¡œ(QBO ë§í¬ ì§ê²°) â€“ _ì‚¬ì „ PoC í•„ìˆ˜_

- QBO Payment Link ìƒì„± ì†ë„/ëª¨ë°”ì¼ UX/ì›¹í›… ì‹ ë¢°ë„ **ì‚¬ì „ ì¸¡ì •**.
- ì„±ê³µ ì‹œ ì‚¬ìš©, ì‹¤íŒ¨ ì‹œ ì¦‰ì‹œ PGë¡œ ì „í™˜.

---

## 11. ì ‘ê·¼ì„±Â·UX ê°€ë“œ

- ëª¨ë“  í•µì‹¬ í”Œë¡œìš° **í‚¤ë³´ë“œë§Œìœ¼ë¡œ ì™„ë£Œ** ê°€ëŠ¥, ë²„íŠ¼ ëŒ€ë¹„ 4.5:1 ì´ìƒ, í¬ì»¤ìŠ¤ ë§ ìœ ì§€.
- StylePack ì œì•½ ë¯¸ì¤€ìˆ˜ ì‹œ **ìƒì„± ë²„íŠ¼ ë¹„í™œì„± + ì´ìœ  íˆ´íŒ**.
- 20sâ†‘ ì§„í–‰ ìƒíƒœ, 40sâ†‘ í´ë°±(í…ìŠ¤íŠ¸ ìŠ¤í™ ì´ˆì•ˆ + ì´ë©”ì¼ ì•Œë¦¼ êµ¬ë…).

---

## 12. KPI ì •ì˜Â·ê³„ì¸¡

- **ì œì•ˆ ì™„ë£Œìœ¨** = (ì œì•ˆ 3ì¢… ì™„ê²° ê±´ / ìƒì„± ì‹œë„ ê±´)Ã—100
  - ë¶„ëª¨: POST `/api/requests` ì„±ê³µ, ë¶„ì: ì›Œì»¤ ì½œë°± 3ì¢… ì™„ë£Œ.
- **ê²°ì œ ì „í™˜ìœ¨** = (DEPOSIT_PAID ìš”ì²­ / ì œì•ˆ 3ì¢… ì „ë‹¬ ìš”ì²­)Ã—100
- **ìƒë‹´ ì‹œê°„ 50%â†“**: ë² ì´ìŠ¤ë¼ì¸ T1(í˜„í–‰) ëŒ€ë¹„ MVP T2(ì œì•ˆâ†’ê²°ì œí™•ì •) ë¹„êµ.
- ì´ë²¤íŠ¸ ë¡œê¹…: `req_id, step, ts(ms)` ê¸°ë°˜, ëŒ€ì‹œë³´ë“œ ì¹´ë“œ ì œê³µ.

---

## 13. ìˆ˜ìš© ê¸°ì¤€(í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤)

- **ACâ€‘01 ìƒì„± ë¹„í™œì„±**: ì‚¬ì´ì¦ˆÂ·ìŠ¤íƒ€ì¼ ë¯¸ì„ íƒ ì‹œ ë²„íŠ¼ ë¹„í™œì„± + íˆ´íŒ(Cypress).
- **ACâ€‘02 ì œì•ˆ 3ì¢…**: ì´ë¯¸ì§€(ì›Œí„°ë§ˆí¬)Â·íŒ”ë ˆíŠ¸Â·ì‚¬ì–‘Â·ë°°ì§€Â·ê°€ê²© ë²”ìœ„ 3ì¹´ë“œ ìŠ¤ëƒ…ìƒ· ê²€ì¦.
- **ACâ€‘03 ê¸ˆì§€ì–´ ì²˜ë¦¬**: ë¡œê³ /ìºë¦­í„° í¬í•¨ â†’ â€œëŒ€ì²´ì•ˆ ì•ˆë‚´â€ í† ìŠ¤íŠ¸ + ë¯¸ìƒì„± ì‚¬ìœ  ë¡œê·¸.
- **ACâ€‘04 ê²°ì œ ë§í¬**: ì„ í˜¸ì•ˆ ì„ íƒ í›„ 3ì´ˆ ë‚´ ë§í¬ í‘œì‹œÂ·ì´ë©”ì¼ ìˆ˜ì‹ (Mock webhook).
- **ACâ€‘05 ìƒíƒœ ë™ê¸°í™”**: ê²°ì œ ì™„ë£Œ ì›¹í›… â†’ `payment_status=DEPOSIT_PAID` ì „ì´ í™•ì¸.
- **ACâ€‘06 ê°ì‚¬ ë¡œê·¸**: ë£° íˆíŠ¸ ì‹œ `LogsAudit.rule_id/action` ê¸°ë¡ ì¡´ì¬(SQL ê²€ì¦).

---

## 14. ë§ˆì¼ìŠ¤í†¤ ë° êµ¬í˜„ í˜„í™©

### êµ¬í˜„ ì™„ë£Œ ìƒíƒœ (2025-11-09 ê¸°ì¤€)

**Phase 1 (W1) - âœ… 90% ì™„ë£Œ**

- âœ… DB ìŠ¤í‚¤ë§ˆ ì „ì²´ êµ¬í˜„ (stylepacks, size_categories, requests, proposals, rules_reality, logs_audit)
- âœ… ê´€ë¦¬ì ì‹œìŠ¤í…œ (profiles, user_roles, allowed_admin_emails í…Œì´ë¸”)
- âœ… Admin Dashboard + StylePacks/SizeCategories/RealityRules Manager
- âœ… ê¸°ë³¸ Edge Functions (create-request, get-request)
- âœ… ê³ ê° ì—¬ì • í˜ì´ì§€ (Size/Style ì„ íƒ, DesignDetails)
- âœ… í•œêµ­ì–´ i18n ì§€ì›
- â³ í…ŒìŠ¤íŠ¸ ë°ì´í„° ì…ë ¥ ëŒ€ê¸°

**Phase 2 (W2) - ğŸ”„ ì§„í–‰ ì˜ˆì •**

- âŒ A03: AI ì œì•ˆ ìƒì„± íŒŒì´í”„ë¼ì¸ (Gemini 2.5 Flash Image via Lovable AI Gateway)
- âŒ A04: í˜„ì‹¤ì„± ë£° í‰ê°€ ë° ë°°ì§€ ìƒì„±
- âŒ A01-A02: ë³´ì•ˆ ê°•í™” (ë©±ë“±ì„±, ë ˆì´íŠ¸ë¦¬ë°‹, MIME ê²€ì¦)
- âŒ P02: ì œì•ˆ ì¹´ë“œ UI ì™„ì„± ë° ë°ì´í„° ì—°ë™
- ì˜ˆìƒ ê¸°ê°„: 6-9ì¼

**Phase 3 (W3) - ë¯¸ì°©ìˆ˜**

- ê²°ì œ í†µí•© (Stripe)
- ì´ë©”ì¼ ì•Œë¦¼
- ì„ë² ë“œ ì•ˆì •í™”

**Phase 4 (W4) - ë¯¸ì°©ìˆ˜**

- ë² íƒ€ í…ŒìŠ¤íŠ¸ (ì‹¤ìš”ì²­ â‰¥10)
- í”„ë¡¬í”„íŠ¸/ê°€ì¤‘ì¹˜ íŠœë‹
- ì„±ëŠ¥ ìµœì í™”

---

## 15. ì˜¤í”ˆ ì´ìŠˆ(ê²°ì • í•„ìš”)

1. ì—…ë¡œë“œ ìƒí•œ(ìµœëŒ€ 5ì¥/ì´ 100MB) ê³ ì • ì—¬ë¶€
2. ì œì•ˆ ì´ë¯¸ì§€ í•´ìƒë„/ì›Œí„°ë§ˆí¬(ì˜ˆ: 1600Ã—1600, ìš°í•˜ë‹¨)
3. ì˜ˆì•½ê¸ˆ ì‚°ì‹(ê³ ì •ì•¡ vs ê¸°ë³¸ê°€ì˜ x%)
4. ê²°ì œ ìˆ˜ë‹¨ ìµœì¢… ê²°ì •(Stripe/PG ê¶Œì¥ vs QBO ë§í¬) ë° QBO ê³„ì • ë§¤í•‘ í…Œì´ë¸”(ì°¨ê¸°)

---

## 16. ë¶€ë¡

### A. ì´ˆê¸° SizeCategory ìƒ˜í”Œ

| ì½”ë“œ | í‹°ì–´/ì§€ë¦„/ë†’ì´  | ì„œë¹™  | ê¸°ë³¸ê°€(ì˜ˆ) | ë¦¬ë“œíƒ€ì„ |
| ---- | --------------- | ----- | ---------- | -------- |
| S    | 1T 6â€³Ã—4â€³        | 8â€“10  | $85â€“$110   | 3â€“5ì¼    |
| M    | 2T 6â€³+8â€³(ê° 4â€³) | 26â€“30 | $220â€“$280  | 5â€“7ì¼    |
| L    | 3T 6â€³+8â€³+10â€³    | 50+   | $420â€“$520  | 7â€“10ì¼   |

### B. StylePack ë©”íƒ€ í•„ë“œ

`name, images[], palette_range(H/S/L), shape_template(1T/2T/3T), allowed_accents[], banned_terms[], lora_ref, notes`

### C. í˜„ì‹¤ì„± ë£° ì˜ˆì‹œ

- ì§€ì§€ëŒ€ í•„ìš”: 2T ì´ìƒ ë˜ëŠ” ë†’ì´ â‰¥ 5â€³
- ì¥ì‹ ë°€ë„ ê²½ê³ : í‘œë©´ ë©´ì  ëŒ€ë¹„ ì¥ì‹ ìš”ì†Œ ìˆ˜ ì„ê³„ ì´ˆê³¼
- ìš´ì†¡ ë¦¬ìŠ¤í¬: ì˜¨ë„ > 28â„ƒ ë˜ëŠ” ì´ë™ê±°ë¦¬ > 25mi

---

## 17. ê¸°ìˆ  ìŠ¤íƒ (Implementation Stack)

### 17.1 í”„ë¡ íŠ¸ì—”ë“œ

- **í”„ë ˆì„ì›Œí¬**: React 18.3 + TypeScript
- **ë¹Œë“œ**: Vite
- **ìŠ¤íƒ€ì¼ë§**: Tailwind CSS + shadcn/ui components
- **ìƒíƒœê´€ë¦¬**: TanStack Query (React Query)
- **ë¼ìš°íŒ…**: React Router v6
- **êµ­ì œí™”**: i18next (í•œêµ­ì–´/ì˜ì–´ ì§€ì›)

### 17.2 ë°±ì—”ë“œ (Lovable Cloud)

- **ë°ì´í„°ë² ì´ìŠ¤**: Supabase (PostgreSQL)
- **ì¸ì¦**: Supabase Auth (Email + ê´€ë¦¬ì í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸)
- **ìŠ¤í† ë¦¬ì§€**: Supabase Storage (cake-inspiration ë²„í‚·)
- **ì„œë²„ë¦¬ìŠ¤ í•¨ìˆ˜**: Supabase Edge Functions (Deno)
- **RLS**: Row Level Security ì •ì±… ì ìš©
- **ì‹¤ì‹œê°„**: Supabase Realtime (í–¥í›„)

### 17.3 AI/ì´ë¯¸ì§€ ìƒì„±

- **ëª¨ë¸**: Google Gemini 2.5 Flash Image (`google/gemini-2.5-flash-image-preview`)
- **API Gateway**: Lovable AI Gateway (`https://ai.gateway.lovable.dev/v1/chat/completions`)
- **ì¸ì¦**: LOVABLE_API_KEY (ìë™ ì œê³µ)
- **êµ¬í˜„ ë°©ì‹**: Edge Function ê¸°ë°˜ ë¹„ë™ê¸° ì²˜ë¦¬
- **ì¶œë ¥**: Base64 â†’ Supabase Storage â†’ ê³µê°œ URL

### 17.4 ê²°ì œ (Phase 3)

- **PG**: Stripe (ê¶Œì¥)
- **íšŒê³„ ë™ê¸°í™”**: QuickBooks Online (ì°¨ê¸°)

### 17.5 ë°°í¬ ë° ì¸í”„ë¼

- **í˜¸ìŠ¤íŒ…**: Lovable Cloud (ìë™ ë°°í¬)
- **ë„ë©”ì¸**: lovable.app ì„œë¸Œë„ë©”ì¸
- **CI/CD**: Lovable ìë™ ë¹Œë“œ/ë°°í¬
- **ëª¨ë‹ˆí„°ë§**: Supabase Dashboard + Edge Function Logs
